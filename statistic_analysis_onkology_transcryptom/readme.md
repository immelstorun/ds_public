<a id='top'></a>

<p align="center">
<a href="https://t.me/immelst0run">
  <img src="https://img.shields.io/badge/t.me/immelst0run-blue?logo=telegram&logoColor=yellow" alt="TG profile">
 </a>
</p>

<p align="center">
  <a href="https://github.com/immelstorun">
    <img src="https://img.shields.io/badge/-immelstorun-blue?style=flat&logo=github" alt="GitHub Repo">
  </a>
</p>



<p align="center">
  <img src="https://img.shields.io/badge/python_3.11-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54" style="border-radius: 5px;" />
  <img src="https://img.shields.io/badge/pandas-%23150458.svg?style=for-the-badge&logo=pandas&logoColor=white" style="border-radius: 5px;" />
  <img src="https://img.shields.io/badge/scikit--learn-%23F7931E.svg?style=for-the-badge&logo=scikit-learn&logoColor=white" style="border-radius: 5px;" />
  <img src="https://img.shields.io/badge/scipy-red.svg?style=for-the-badge&logo=scipy&logoColor=white" style="border-radius: 5px;" />
</p>

<h1 align="center">Пространственная транскриптомика в онкологии</h1>
<p align="center">Цель проекта - поиск отличий в организации микроокружения у пожилых и молодых пациентов.</p>

## Оглавление
[Описание проекта](#описание-проекта) | [Описание данных](#описание-данных) | [Задачи от заказчика](#задачи-проекта) | [Критерии оценки](#критерии-оценки-результата)

[План работы](#план-работы) | [Результаты](#результаты) 

[Выводы](#выводы)

## Описание проекта
Прикладной анализ данных и статистическоe обоснование гипотез по тестам и графикам статической значимости на основе биомедицинского датасета по пространственной транскриптомике пациентов с плоскоклеточным раком.

## Описание данных

Биоинформатический датасет (в каталоге `data`) по пространственной транскриптомике пациентов с плоскоклеточным раком. В нем клетки (колонка `cell_type`) объединены в микроокружения (колонка `cell_interaction`) в зависимости от взаимодействия этих клеток.

Также в датасете есть следующие колонки:

* `distance_to_vasculature` — расстояние до ближайших сосудов;
* `distance_to_largest_cell` — расстояние до ближайшей крупной клетки;
* `immune_marker_1` — экспрессия иммунного маркера 1 в данной клетке;
* `immune_marker_2` — экспрессия иммунного маркера 2 в данной клетке;
* `cell_type` — тип клетки;
* `area_of_cell` — размер клетки;
* `case_id` — уникальный ID пациента.

>[Дополнительная информация по теме][def2]

## Задачи от заказчика:

### 1. Статистическая значимость между типом клетки и:
   - **а) Размером клетки (`area_of_cell`)**  
     Добавьте hue по возрастным группам.
   - **б) Экспрессией иммунных маркеров (`immune_marker_1`, `immune_marker_2`)**  
     Добавьте hue по возрастным группам.
   - **в) Дистанцией до ближайших объектов (`distance_to_vasculature`, `distance_to_largest_cell`)**  
     Добавьте hue по возрастным группам.
   *Используйте box_plot/swarplot, где по оси X будет тип клеток, а по оси Y — оцениваемая статистика.*

### 2. Клеточное микроокружение:
   **В каком микроокружении клеток какого типа статистически больше, чем в других?**  
   Используйте box_plot/swarplot с hue по микроокружениям:
   - **Ось X:** типы клеток
   - **Ось Y:** количество клеток
   *Учитывайте количество для каждого пациента отдельно для репрезентативности выборки.*

### 3. Доля микроокружения в тканях пациентов разных возрастов:
   Используйте box_plot/swarplot с hue по возрастным группам:
   - **Ось X:** микроокружения
   - **Ось Y:** доля в ткани пациента
   *Доли считайте для каждого пациента отдельно.*

### 4. Иммунные клетки и их расположение:
   **Лежат ли иммунные клетки (`Immune type 1` и `Immune type 2`) ближе к сосудам и крупным клеткам, чем стромальные клетки (`Stroma cells`) у молодых, но не у пожилых пациентов?**  
   Проверьте гипотезу с использованием `бутстрапа`.

### 5. Иммунные клетки и расстояние до сосудов:
   **Лежат ли иммунные клетки в среднем ближе к сосудам у молодых, но не у пожилых пациентов?**  
   Проверьте гипотезу с использованием `пермутационного теста` и комбинируйте p-values для каждой возрастной группы с помощью соответствующего инструмента.


## Критерии оценки результата
>Критерий 1: правильность решения

Правильность решения (за каждую задачу — 2 балла). Необходимо убедиться, что данные обработаны верно, выдача соответствует условию задачи. В первых двух заданиях необходимо проконтролировать, что собиралась статистика для каждого пациента, а результирующий график включает в себя данные по всем пациентам. Измененная задача/текст или условия задачи/assert == -3 балла за задачу.

| Условия задачи                                                                                   | Баллы |
|--------------------------------------------------------------------------------------------------|-------|
| Задача решена верно (всего 5 задач)                                                              | 2     |
| Все задачи решены верно — 10 баллов                                                              | 10    |
| Ошибка в выборе статистического теста                                                             | 2     |
| Задача решена неверно (Используются неверные выборки, ошибка в расчетах, перепутаны выборки и т.д.) | 0     |
| Задача решена почти верно, есть минорные ошибки. Либо правильно выбран стат-тест, либо правильно сформирована выборка. | 1     |

>Критерий 2. 

Правильность оформления решения по PEP8

| Условия задачи                                                  | Баллы |
|-----------------------------------------------------------------|-------|
| Код красивый и правильный, есть несколько мелких помарок       | 10    |
| Нарушения PEP8 примерно в 20% случаев                           | 8     |
| Нарушения PEP8 примерно в 50% случаев                           | 5     |
| PEP8 нет                                                        | 0     |

>Дополнительные баллы
1. **Подробное описание результатов анализа и выводов:** 
   Основываясь на результаты статистического анализа, обнаружены статистически значимые различия между исследуемыми группами. Это позволяет сделать вывод о наличии значимых различий в их характеристиках, что связано с целью исследования — `1 балл`.

2. **Оценка значимости и величины эффектов:**
   В ходе анализа была проведена не только проверка наличия статистически значимых различий, но и оценка значимости и величины эффектов. Это позволяет более глубоко проанализировать результаты исследования, определить практическую значимость различий и сделать осмысленные заключения на основе полученных данных — `1 балл`.

3. **Описание ограничений проведенного анализа и возможных улучшений:**
   Были выявлены ограничения, влияющие на результаты и интерпретацию данных. Для улучшения анализа предлагается провести дополнительные эксперименты для минимизации влияния этих ограничений. Например, можно увеличить объем выборки или уточнить методику измерения характеристик — `1 балл`.

## План работы
- Шаг 1: Подготовка данных
    - Загрузка данных
    - Предобработка датасетов (Пропуски и явные дубликаты)
  
- Шаг 2: Итеративный проход по задачам заказчика
    - 1. Формулирование задачи
    - 2. Формирование выборки
    - 3. Графическое описание характеристик выборки
    - 4. Проведение статистического анализа
    - 5. Подробное описание результатов анализа и сделанных на их основе выводов. 
       >Описание результатов и выводов должно быть понятным и связанным с целью исследования. Ваши выводы должны отражать результаты статистического анализа и позволять сделать осмысленные заключения о наличии или отсутствии статистически значимых различий в исследуемых группах. 
    - Оценка значимости и величины эффектов
      >Оценка значимости и величины эффектов позволяет более глубоко проанализировать результаты исследования, определить практическую значимость различий и сделать осмысленные заключения на основе полученных данных.
    - Описание ограничений проведенного анализа и возможных улучшений. 
      >Анализ и объяснение ограничений, которые могут оказывать влияние на полученные результаты и интерпретацию данных. Предложение о конкретных способах улучшить проведенный анализ и минимизировать ограничения.

- Шаг 3: Формулирование общих выводов по проекту


## Результаты
Код решения приложен в ноутбуке

## Выводы
В ходе работы над проектом был отработан прикладной анализ данных и статистическоe обоснование гипотез по тестам и графикам статической значимости на основе биомедицинского датасета по пространственной транскриптомике пациентов с плоскоклеточным раком.

На примерах нескольких типов задач были отмечены различия в распределениях различных характеристик микробиомов между двумя возрастными группами. Были предприняты попытки - статистически обосновать выявленные различия.


<a href="#top"><img src='https://img.shields.io/badge/К началу-&#x21A9-blue'></a>

[def2]: https://institut-curie.org/popin/spatial-omics